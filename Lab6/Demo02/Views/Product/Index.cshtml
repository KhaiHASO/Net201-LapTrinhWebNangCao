@model IEnumerable<Demo02.Models.Product>

@{
    ViewData["Title"] = "Demo 1: Loosely Coupled";
}

<div class="text-center mb-5">
    <h1 class="display-4 text-primary fw-bold">Demo 1: Tại sao cần DI?</h1>
    <p class="lead">Minh họa tính "Lỏng lẻo" (Loosely Coupled) của Dependency Injection.</p>
</div>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow border-0">
            <div class="card-header bg-white py-3">
                <h5 class="mb-0 text-secondary">
                    Chế độ tính giá hiện tại: 
                    <span class="badge bg-danger fs-5">@ViewBag.PromotionName</span>
                </h5>
            </div>
            <div class="card-body">
                <table class="table table-striped table-hover align-middle">
                    <thead class="table-dark">
                        <tr>
                            <th>Sản phẩm</th>
                            <th class="text-center">Số lượng</th>
                            <th class="text-end">Đơn giá</th>
                            <th class="text-end">Thành tiền (Gốc)</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td class="fw-bold">@item.Name</td>
                                <td class="text-center">@item.Quantity</td>
                                <td class="text-end">@item.Price.ToString("N0") đ</td>
                                <td class="text-end text-muted">@((item.Price * item.Quantity).ToString("N0")) đ</td>
                            </tr>
                        }
                    </tbody>
                    <tfoot class="table-primary border-top-3">
                        <tr>
                            <td colspan="3" class="text-end fw-bold fs-4">TỔNG THANH TOÁN:</td>
                            <td class="text-end fw-bold fs-4 text-danger">@(((decimal)ViewBag.TotalAmount).ToString("N0")) đ</td>
                        </tr>
                    </tfoot>
                </table>

                <div class="alert alert-warning mt-3">
                    <i class="bi bi-lightbulb-fill me-2"></i><strong>Thử thách:</strong> 
                    Hãy vào <code>Program.cs</code> đổi <code>StandardCalculator</code> thành <code>BlackFridayCalculator</code> và chạy lại (F5) để xem Tổng thanh toán thay đổi, mặc dù không hề sửa code trong Controller!
                </div>
            </div>
            <div class="card-footer text-center py-3">
                <a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary">
                    <i class="bi bi-house-door-fill me-1"></i>Về Trang Chủ
                </a>
                <a href="javascript:window.location.reload();" class="btn btn-primary ms-2">
                    <i class="bi bi-arrow-clockwise me-1"></i>Tải lại trang
                </a>
            </div>
        </div>
    </div>
</div>
